---
const navList: { href: string; label: string }[] = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/events", label: "Events" },
  { href: "/journal", label: "Journal" },
  { href: "/contact", label: "Contact" },
  { href: "/sponsors", label: "Sponsors" }
];

const currentPath = Astro.url.pathname;

const isActive = (href: string) => {
  let path = currentPath;
  // Take out trailing slash
  if(path.endsWith("/")) {
    path = path.slice(0, -1);
  }
  // Isolate page name
  let i = path.lastIndexOf("/");
  if(i != -1) {
    path = path.substring(i+1);
  }
  const hrefName = href.substring(1);
  return path === hrefName;
}
---

<nav>
  <!-- Desktop -->
  <ul class="hidden items-center gap-1 sm:flex">
    {navList.map(({ href, label }) => (
      <li>
        <a
          href={href}
          class:list={[
            "rounded-xl px-3 py-2 text-sm font-semibold transition",
            "hover:bg-[#003049]/10 hover:text-[#003049]",
            "dark:hover:bg-white/10 dark:hover:text-[#fef8ec]",
            isActive(href)
              ? "bg-[#003049] text-[#fef8ec] hover:bg-[#003049] hover:text-[#fef8ec] dark:bg-[#fef8ec] dark:text-[#003049] dark:hover:bg-[#fef8ec]"
              : "text-slate-700 dark:text-[#fef8ec]",
          ]}
        >
          {label}
        </a>
      </li>
    ))}
  </ul>

  <!-- Mobile (no JS) -->
  <details class="relative sm:hidden">
    <summary
      class="list-none cursor-pointer rounded-xl border border-black/10 bg-white/70 px-3 py-2 text-sm font-semibold text-[#003049] backdrop-blur hover:bg-white
             dark:border-white/20 dark:bg-white/10 dark:text-[#fef8ec] dark:hover:bg-white/15"
    >
      Menu
    </summary>

    <div
      class="absolute right-0 mt-2 w-52 overflow-hidden rounded-2xl border border-black/10 bg-white shadow-lg
             dark:border-white/20 dark:bg-[#003049]"
    >
      <ul class="p-2">
        {navList.map(({ href, label }) => (
          <li>
            <a
              href={href}
              class:list={[
                "block rounded-xl px-3 py-2 text-sm font-semibold transition",
                "hover:bg-[#003049]/10 hover:text-[#003049]",
                "dark:hover:bg-white/10 dark:hover:text-[#fef8ec]",
                isActive(href)
                  ? "bg-[#003049] text-[#fef8ec] dark:bg-[#fef8ec] dark:text-[#003049]"
                  : "text-slate-700 dark:text-[#fef8ec]",
              ]}
            >
              {label}
            </a>
          </li>
        ))}
      </ul>
    </div>
  </details>
</nav>
